FROM node:22-alpine3.20 AS build

COPY ../package.json package-lock.json /app/
WORKDIR /app

RUN echo "ğŸ“¦ Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸..." && npm ci

COPY .. .

RUN echo "ğŸ“ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ /app Ğ¿ĞµÑ€ĞµĞ´ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸ĞµĞ¹:" && ls -la

RUN echo "ğŸš€ Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ Nuxt 3 ÑĞ°Ğ¹Ñ‚..." && npm run generate

RUN echo "ğŸ“ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ .output Ğ¿Ğ¾ÑĞ»Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸:" && ls -la .output
RUN echo "ğŸ“ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ .output/public:" && ls -la .output/public

FROM nginx:alpine

COPY --from=build /app/.output/public /usr/share/nginx/html

RUN echo "ğŸš€ Ğ Ğ°Ğ·Ğ´Ğ°Ñ‡Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ĞºĞ¸ Ğ½Ğ° port: 80..."
EXPOSE 80